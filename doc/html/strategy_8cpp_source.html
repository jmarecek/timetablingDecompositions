<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>MemosTimetabling: src/strategy.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>src/strategy.cpp</h1><a href="strategy_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*  This file is part of the Solver for Udine Course Timetabling Problem based </span>
<a name="l00002"></a>00002 <span class="comment"> *  on Multiphase Exploitation of Multiple Objective-/Value-restricted Submodels </span>
<a name="l00003"></a>00003 <span class="comment"> *  (abbreviated MEMOS for Timetabling).</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> *  Copyright 2009 Jakub Marecek</span>
<a name="l00006"></a>00006 <span class="comment"> *  Copyright 2009 The University of Nottingham</span>
<a name="l00007"></a>00007 <span class="comment"> *  http://www.cs.nott.ac.uk/~jxm/timetabling/memos/</span>
<a name="l00008"></a>00008 <span class="comment"> *  http://memos-solvers.sourceforge.net/ </span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> *  MEMOS for Timetabling is free software: you can redistribute it and/or </span>
<a name="l00011"></a>00011 <span class="comment"> *  modify it under the terms of the GNU General Public License as published by </span>
<a name="l00012"></a>00012 <span class="comment"> *  the Free Software Foundation, either version 3 of the License, or (at your </span>
<a name="l00013"></a>00013 <span class="comment"> *  option) any later version. It would be greatly appreciated, however, if you</span>
<a name="l00014"></a>00014 <span class="comment"> *  could cite the following paper in any work that uses it:</span>
<a name="l00015"></a>00015 <span class="comment"> *    Edmund K. Burke, Jakub Marecek, Andrew J. Parkes, and Hana Rudova: </span>
<a name="l00016"></a>00016 <span class="comment"> *    Decomposition, Reformulation, and Diving in University Course Timetabling.</span>
<a name="l00017"></a>00017 <span class="comment"> *    Computers and Operations Research. DOI 10.1016/j.cor.2009.02.023</span>
<a name="l00018"></a>00018 <span class="comment"> */</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 <span class="preprocessor">#include "<a class="code" href="strategy_8h.html">strategy.h</a>"</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include "<a class="code" href="solver__config_8h.html">solver_config.h</a>"</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include "<a class="code" href="neighbourhood_8h.html">neighbourhood.h</a>"</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include "<a class="code" href="model_8h.html">model.h</a>"</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include "<a class="code" href="cuts_8h.html">cuts.h</a>"</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="keyword">using namespace </span>Udine;
<a name="l00029"></a>00029 
<a name="l00030"></a><a class="code" href="strategy_8cpp.html#e32e602f9e9db5c127e1eece8c797425">00030</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="strategy_8cpp.html#e32e602f9e9db5c127e1eece8c797425">roundProperly</a>(<span class="keywordtype">double</span> x) { <span class="keywordflow">return</span> int(std::floor(x + 0.5f)); }
<a name="l00031"></a>00031 
<a name="l00032"></a><a class="code" href="class_udine_1_1_strategy_i.html#c9b811d84791229ad00ec99441671cf3">00032</a> <span class="keywordtype">int</span> StrategyI::sumMissingCourseDays() {
<a name="l00033"></a>00033   <span class="keywordflow">if</span> (<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a> == <a class="code" href="namespace_udine.html#1748c504ab86482c137f902a5b474378ebd0021c0608a1b50450cd305a2e9f4c">FixDay</a> || <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a> == <a class="code" href="namespace_udine.html#1748c504ab86482c137f902a5b474378d0dea5c2f48fa71a1600db62dc494764">FixPeriod</a>)
<a name="l00034"></a>00034     <span class="keywordflow">return</span> <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#4f6c8b92a5f71100d10b8c698ecca3ef">penaltyMinCourseDays</a>;
<a name="l00035"></a>00035 
<a name="l00036"></a>00036   <span class="keywordtype">int</span> i = 0;
<a name="l00037"></a>00037   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#6020dc8bfec316fa74b5594ce6bb12e9">getCourseCount</a>(); c++)
<a name="l00038"></a>00038     <span class="keywordflow">try</span> { i += <a class="code" href="strategy_8cpp.html#e32e602f9e9db5c127e1eece8c797425">roundProperly</a>(getValue(<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#81e79cbc7591456ec72e0130a2a79ae1">courseMinDayViolations</a>[c])); } 
<a name="l00039"></a>00039     <span class="keywordflow">catch</span> (IloAlgorithm::NotExtractedException e)  { std::cerr &lt;&lt; <span class="stringliteral">"Error retrieving "</span> &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#81e79cbc7591456ec72e0130a2a79ae1">courseMinDayViolations</a>[c].getName() &lt;&lt; <span class="stringliteral">"."</span> &lt;&lt; std::endl; }
<a name="l00040"></a>00040     <span class="keywordflow">catch</span> (...)  { std::cerr &lt;&lt; <span class="stringliteral">"Unknown error retrieving "</span> &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#81e79cbc7591456ec72e0130a2a79ae1">courseMinDayViolations</a>[c].getName() &lt;&lt; <span class="stringliteral">"."</span> &lt;&lt; std::endl; <span class="keywordflow">throw</span>; }
<a name="l00041"></a>00041   <span class="keywordflow">return</span> i;
<a name="l00042"></a>00042 }
<a name="l00043"></a>00043 
<a name="l00044"></a><a class="code" href="class_udine_1_1_strategy_i.html#045b6e91b05c618173a100a72b097eb4">00044</a> <span class="keywordtype">int</span> <a class="code" href="class_udine_1_1_strategy_i.html#045b6e91b05c618173a100a72b097eb4">StrategyI::sumSingletonChecks</a>() {
<a name="l00045"></a>00045   <span class="keywordflow">if</span> (<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a> == <a class="code" href="namespace_udine.html#1748c504ab86482c137f902a5b474378d0dea5c2f48fa71a1600db62dc494764">FixPeriod</a>)
<a name="l00046"></a>00046     <span class="keywordflow">return</span> <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#69f83574b01b2b10f11d76405eb116b1">penaltyCompactness</a>;
<a name="l00047"></a>00047 
<a name="l00048"></a>00048   <span class="keywordtype">int</span> i = 0;
<a name="l00049"></a>00049   <span class="comment">// TODO: if (config.getParam(UseSpreadOnlyNeighbourhoods)) return i;</span>
<a name="l00050"></a>00050   <span class="keywordtype">int</span> limit = <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#070ffcb647a98cd8b71427cbd2a52e11">getCheckCount</a>();
<a name="l00051"></a>00051   <span class="keywordflow">if</span> ((<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a> == <a class="code" href="namespace_udine.html#1748c504ab86482c137f902a5b474378b86b6f367bcdf26a24c1eda8835804ec">Surface</a> &amp;&amp; <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#442ff0dfb189dd3f733e0876f3c17405">getParam</a>(<a class="code" href="namespace_udine.html#7a28bfbd1d7d606db82f999b139d9aaef428f45eea1a07ce50a5a97293294da0">UseHeuristicCompactnessAtSurface</a>))
<a name="l00052"></a>00052       || (<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a> == <a class="code" href="namespace_udine.html#1748c504ab86482c137f902a5b474378ebd0021c0608a1b50450cd305a2e9f4c">FixDay</a> &amp;&amp; <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#442ff0dfb189dd3f733e0876f3c17405">getParam</a>(<a class="code" href="namespace_udine.html#7a28bfbd1d7d606db82f999b139d9aae3b9f2cabaa49f6c6ea247ff9d675e881">UseHeuristicCompactnessInDayDives</a>)))
<a name="l00053"></a>00053     limit = 1;
<a name="l00054"></a>00054 
<a name="l00055"></a>00055   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> u = 0; u &lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#2bcb4470bb54b8e6b1017c84df8f780f">getProperCurriculumCount</a>(); u++)
<a name="l00056"></a>00056     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#a69b0cbf804f657b02b9bebd807a11ce">getDayCount</a>(); d++)
<a name="l00057"></a>00057       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s = 0; s &lt; limit; s++)
<a name="l00058"></a>00058         <span class="keywordflow">try</span> { i += <a class="code" href="strategy_8cpp.html#e32e602f9e9db5c127e1eece8c797425">roundProperly</a>(getValue(<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#d227516b2b7214b0a902ce72d3c4f0b1">singletonChecks</a>[u][d][s])); }
<a name="l00059"></a>00059         <span class="keywordflow">catch</span> (IloAlgorithm::NotExtractedException e)  { std::cerr &lt;&lt; <span class="stringliteral">"Error retrieving "</span> &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#d227516b2b7214b0a902ce72d3c4f0b1">singletonChecks</a>[u][d][s].getName() &lt;&lt; std::endl; }
<a name="l00060"></a>00060         <span class="keywordflow">catch</span> (...) { std::cerr &lt;&lt; <span class="stringliteral">"Error retrieving "</span> &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#d227516b2b7214b0a902ce72d3c4f0b1">singletonChecks</a>[u][d][s].getName() &lt;&lt; std::endl; <span class="keywordflow">throw</span>; }
<a name="l00061"></a>00061   <span class="keywordflow">return</span> i;
<a name="l00062"></a>00062 }
<a name="l00063"></a>00063 
<a name="l00064"></a><a class="code" href="class_udine_1_1_strategy_i.html#34cb6a3734cc8cd25589b2946c2e6a45">00064</a> <span class="keywordtype">int</span> <a class="code" href="class_udine_1_1_strategy_i.html#34cb6a3734cc8cd25589b2946c2e6a45">StrategyI::sumMissingSeats</a>() {
<a name="l00065"></a>00065   <span class="keywordtype">int</span> i = 0;
<a name="l00066"></a>00066   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#0236aa15c9e367c0b235a5398d19356c">getRoomCount</a>(<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a>); r++)
<a name="l00067"></a>00067     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#6020dc8bfec316fa74b5594ce6bb12e9">getCourseCount</a>(); c++)
<a name="l00068"></a>00068       <span class="keywordflow">if</span> (<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#4c909a0eef4e65ba4ab46d61b64fbca3">getCourse</a>(c).<a class="code" href="struct_udine_1_1_course.html#2909492606f4e5219897b2219225858c">students</a> &gt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#f6827d2b6244b724b0f6156228d4bdef">getRoomPerEventCapacity</a>(<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a>, r))
<a name="l00069"></a>00069         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#e66c619fb7725c038dad84d29cf7880e">getPeriodCount</a>(); p++)
<a name="l00070"></a>00070           <span class="keywordflow">try</span> { 
<a name="l00071"></a>00071             <span class="keywordflow">if</span> (<a class="code" href="strategy_8cpp.html#e32e602f9e9db5c127e1eece8c797425">roundProperly</a>(getValue(<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#a2eb63247509b9e19c3ca82b1ff3becd">x</a>[p][r][c])) == 1) 
<a name="l00072"></a>00072               i += <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#4c909a0eef4e65ba4ab46d61b64fbca3">getCourse</a>(c).<a class="code" href="struct_udine_1_1_course.html#2909492606f4e5219897b2219225858c">students</a> - <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#f6827d2b6244b724b0f6156228d4bdef">getRoomPerEventCapacity</a>(<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a>, r);
<a name="l00073"></a>00073           }
<a name="l00074"></a>00074           <span class="keywordflow">catch</span> (IloAlgorithm::NotExtractedException e)  { std::cerr &lt;&lt; <span class="stringliteral">"Error retrieving "</span> &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#a2eb63247509b9e19c3ca82b1ff3becd">x</a>[p][r][c].getName() &lt;&lt; std::endl; }
<a name="l00075"></a>00075           <span class="keywordflow">catch</span> (...) { std::cerr &lt;&lt; <span class="stringliteral">"Error retrieving "</span> &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#a2eb63247509b9e19c3ca82b1ff3becd">x</a>[p][r][c].getName() &lt;&lt; std::endl; <span class="keywordflow">throw</span>; }
<a name="l00076"></a>00076   <span class="keywordflow">return</span> i;
<a name="l00077"></a>00077 }
<a name="l00078"></a>00078 
<a name="l00079"></a><a class="code" href="class_udine_1_1_strategy_i.html#b1995072fcfd33d9e4844daad65d909b">00079</a> <span class="keywordtype">int</span> <a class="code" href="class_udine_1_1_strategy_i.html#b1995072fcfd33d9e4844daad65d909b">StrategyI::sumExtraRoomsUsed</a>() {
<a name="l00080"></a>00080   <span class="keywordtype">int</span> i = 0;
<a name="l00081"></a>00081   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#6020dc8bfec316fa74b5594ce6bb12e9">getCourseCount</a>(); c++)
<a name="l00082"></a>00082     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#0236aa15c9e367c0b235a5398d19356c">getRoomCount</a>(<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a>); r++)
<a name="l00083"></a>00083       <span class="comment">// TODO: Why this could fail</span>
<a name="l00084"></a>00084       <span class="keywordflow">try</span> { i += <a class="code" href="strategy_8cpp.html#e32e602f9e9db5c127e1eece8c797425">roundProperly</a>(getValue(<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#327855fbc3c49651423ea183f5420add">courseRooms</a>[c][r])); } 
<a name="l00085"></a>00085       <span class="keywordflow">catch</span> (IloAlgorithm::NotExtractedException e)  { std::cerr &lt;&lt; <span class="stringliteral">"Error retrieving "</span> &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#327855fbc3c49651423ea183f5420add">courseRooms</a>[c][r].getName() &lt;&lt; std::endl; }
<a name="l00086"></a>00086       <span class="keywordflow">catch</span> (...) { std::cerr &lt;&lt; <span class="stringliteral">"Error retrieving "</span> &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#327855fbc3c49651423ea183f5420add">courseRooms</a>[c][r].getName() &lt;&lt; std::endl; <span class="keywordflow">throw</span>; }
<a name="l00087"></a>00087   i -= <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#6020dc8bfec316fa74b5594ce6bb12e9">getCourseCount</a>();
<a name="l00088"></a>00088   <span class="keywordflow">return</span> i;
<a name="l00089"></a>00089 }
<a name="l00090"></a>00090 
<a name="l00091"></a><a class="code" href="class_udine_1_1_strategy_i.html#20467bca4c6426ce299a24a53ee94f2b">00091</a> <span class="keywordtype">void</span> <a class="code" href="class_udine_1_1_strategy_i.html#20467bca4c6426ce299a24a53ee94f2b">StrategyI::logNeighbrouhood</a>(<a class="code" href="struct_udine_1_1_neighbourhood.html">Neighbourhood</a> def) {
<a name="l00092"></a>00092   <span class="keywordflow">try</span> {      
<a name="l00093"></a>00093     std::stringstream log;
<a name="l00094"></a>00094     log &lt;&lt; <span class="stringliteral">"&lt;neighbourhood "</span>;
<a name="l00095"></a>00095     log &lt;&lt; <span class="stringliteral">"data='"</span> &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#19bdbb787d800b77fe8565ea543173b1">path</a> &lt;&lt; <span class="stringliteral">"' "</span>;
<a name="l00096"></a>00096     log &lt;&lt; <span class="stringliteral">"discovered='"</span> &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#5d418a03e5e6c0ebe839987e82b2aba0">elapsed</a>() &lt;&lt; <span class="stringliteral">"' "</span>;
<a name="l00097"></a>00097     log &lt;&lt; <span class="stringliteral">"cost='"</span> &lt;&lt; def.<a class="code" href="struct_udine_1_1_neighbourhood.html#8856b8dea41bbcfe7d2b050ec6018907">cost</a> &lt;&lt; <span class="stringliteral">"' "</span>;
<a name="l00098"></a>00098     log &lt;&lt; <span class="stringliteral">"penaltyCompactness='"</span> &lt;&lt; def.<a class="code" href="struct_udine_1_1_neighbourhood.html#69f83574b01b2b10f11d76405eb116b1">penaltyCompactness</a> &lt;&lt; <span class="stringliteral">"' "</span>;
<a name="l00099"></a>00099     log &lt;&lt; <span class="stringliteral">"penaltyMinCourseDays='"</span> &lt;&lt; def.<a class="code" href="struct_udine_1_1_neighbourhood.html#4f6c8b92a5f71100d10b8c698ecca3ef">penaltyMinCourseDays</a> &lt;&lt; <span class="stringliteral">"' "</span>;
<a name="l00100"></a>00100     log &lt;&lt; <span class="stringliteral">"LB='"</span> &lt;&lt; def.<a class="code" href="struct_udine_1_1_neighbourhood.html#e74c0a29e06868cbba038e8ae9500f82">lowerBound</a> &lt;&lt; <span class="stringliteral">"' "</span>;
<a name="l00101"></a>00101     log &lt;&lt; <span class="stringliteral">"'&gt;&lt;definition&gt;"</span> &lt;&lt; std::endl;
<a name="l00102"></a>00102 
<a name="l00103"></a>00103     std::vector&lt;CoursePeriodPair&gt;::iterator itFixPeriod;
<a name="l00104"></a>00104     <span class="keywordflow">for</span> (itFixPeriod = def.<a class="code" href="struct_udine_1_1_neighbourhood.html#888ac9463e2eb016f4ab334bc901fc40">fixPeriod</a>.begin(); 
<a name="l00105"></a>00105          itFixPeriod != def.<a class="code" href="struct_udine_1_1_neighbourhood.html#888ac9463e2eb016f4ab334bc901fc40">fixPeriod</a>.end(); itFixPeriod++) {
<a name="l00106"></a>00106       log &lt;&lt; <span class="stringliteral">"&lt;session course='"</span> &lt;&lt; itFixPeriod-&gt;course &lt;&lt; <span class="stringliteral">"' "</span>;
<a name="l00107"></a>00107       log &lt;&lt; <span class="stringliteral">" period='"</span> &lt;&lt; itFixPeriod-&gt;period &lt;&lt; <span class="stringliteral">"'/&gt;"</span>;
<a name="l00108"></a>00108     }
<a name="l00109"></a>00109 
<a name="l00110"></a>00110     std::vector&lt;CourseDayNumberTriple&gt;::iterator itFixDay;
<a name="l00111"></a>00111     <span class="keywordflow">for</span> (itFixDay = def.<a class="code" href="struct_udine_1_1_neighbourhood.html#150b82a8e44425ee30c140668e59c5c5">fixDay</a>.begin(); 
<a name="l00112"></a>00112          itFixDay != def.<a class="code" href="struct_udine_1_1_neighbourhood.html#150b82a8e44425ee30c140668e59c5c5">fixDay</a>.end(); itFixDay++) {
<a name="l00113"></a>00113       log &lt;&lt; <span class="stringliteral">"&lt;session course='"</span> &lt;&lt; itFixDay-&gt;course &lt;&lt; <span class="stringliteral">"' "</span>;
<a name="l00114"></a>00114       log &lt;&lt; <span class="stringliteral">" day='"</span> &lt;&lt; itFixDay-&gt;day &lt;&lt; <span class="stringliteral">"' "</span>;
<a name="l00115"></a>00115       log &lt;&lt; <span class="stringliteral">" events='"</span> &lt;&lt; itFixDay-&gt;events &lt;&lt; <span class="stringliteral">"'/&gt;"</span>;
<a name="l00116"></a>00116     }
<a name="l00117"></a>00117 
<a name="l00118"></a>00118     log &lt;&lt; <span class="stringliteral">"&lt;/definition&gt;&lt;/neighbourhood&gt;"</span>;
<a name="l00119"></a>00119 
<a name="l00120"></a>00120     <span class="keywordflow">if</span> (<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#c6b5bc705201030d6d7f2001dab10788">config</a>.<a class="code" href="struct_udine_1_1_config.html#442ff0dfb189dd3f733e0876f3c17405">getParam</a>(<a class="code" href="namespace_udine.html#7a28bfbd1d7d606db82f999b139d9aae09f37e22e09953fdac5d84ce61227522">UseNeighbourhoodLogging</a>)) {
<a name="l00121"></a>00121       <a class="code" href="class_udine_1_1_strategy_i.html#a588eceb4e1520c02b2255162374757e">env</a>.out() &lt;&lt; <span class="stringliteral">"&lt;/cplex&gt;\n"</span> &lt;&lt; log.str() &lt;&lt; <span class="stringliteral">"&lt;cplex&gt;"</span> &lt;&lt; std::endl;
<a name="l00122"></a>00122     }
<a name="l00123"></a>00123 
<a name="l00124"></a>00124     std::stringstream filename;
<a name="l00125"></a>00125     filename &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#19bdbb787d800b77fe8565ea543173b1">path</a> &lt;&lt; <span class="stringliteral">".nei"</span> &lt;&lt; (int)def.<a class="code" href="struct_udine_1_1_neighbourhood.html#8856b8dea41bbcfe7d2b050ec6018907">cost</a> &lt;&lt; <span class="stringliteral">".xml"</span>;
<a name="l00126"></a>00126     std::ofstream neiFile(filename.str().c_str(), ios::app);
<a name="l00127"></a>00127     neiFile &lt;&lt; log.str() &lt;&lt; std::endl;
<a name="l00128"></a>00128     neiFile.close();
<a name="l00129"></a>00129   }
<a name="l00130"></a>00130   <span class="keywordflow">catch</span> (...) { std::cerr &lt;&lt; <span class="stringliteral">"There was an error saving the neighbourhood."</span> &lt;&lt; std::endl; <span class="keywordflow">return</span>; }
<a name="l00131"></a>00131 }
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 
<a name="l00134"></a><a class="code" href="class_udine_1_1_strategy_i.html#05c87bf6b3c74568bc31e5c4a996aa36">00134</a> <a class="code" href="struct_udine_1_1_neighbourhood.html">Neighbourhood</a> <a class="code" href="class_udine_1_1_strategy_i.html#05c87bf6b3c74568bc31e5c4a996aa36">StrategyI::getFixPeriodNeighbourhood</a>() {
<a name="l00135"></a>00135   <a class="code" href="struct_udine_1_1_neighbourhood.html">Neighbourhood</a> next;
<a name="l00136"></a>00136   next.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a> = <a class="code" href="namespace_udine.html#1748c504ab86482c137f902a5b474378d0dea5c2f48fa71a1600db62dc494764">FixPeriod</a>;
<a name="l00137"></a>00137   next.<a class="code" href="struct_udine_1_1_neighbourhood.html#8856b8dea41bbcfe7d2b050ec6018907">cost</a> = getObjValue();
<a name="l00138"></a>00138   next.<a class="code" href="struct_udine_1_1_neighbourhood.html#e74c0a29e06868cbba038e8ae9500f82">lowerBound</a> = getBestObjValue();
<a name="l00139"></a>00139   next.<a class="code" href="struct_udine_1_1_neighbourhood.html#4f6c8b92a5f71100d10b8c698ecca3ef">penaltyMinCourseDays</a> = <a class="code" href="class_udine_1_1_strategy_i.html#c9b811d84791229ad00ec99441671cf3">sumMissingCourseDays</a>();
<a name="l00140"></a>00140   next.<a class="code" href="struct_udine_1_1_neighbourhood.html#69f83574b01b2b10f11d76405eb116b1">penaltyCompactness</a> = <a class="code" href="class_udine_1_1_strategy_i.html#045b6e91b05c618173a100a72b097eb4">sumSingletonChecks</a>();
<a name="l00141"></a>00141 
<a name="l00142"></a>00142   <span class="keywordtype">int</span> c, p, r;  <span class="comment">// course, period</span>
<a name="l00143"></a>00143   <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#6020dc8bfec316fa74b5594ce6bb12e9">getCourseCount</a>(); c++)
<a name="l00144"></a>00144     <span class="keywordflow">for</span> (p = 0; p &lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#e66c619fb7725c038dad84d29cf7880e">getPeriodCount</a>(); p++) {
<a name="l00145"></a>00145       <a class="code" href="struct_udine_1_1_course_period_pair.html">CoursePeriodPair</a> pair;
<a name="l00146"></a>00146       pair.<a class="code" href="struct_udine_1_1_course_period_pair.html#56ea1139126925afd8e55ffdd78a4246">period</a> = p;
<a name="l00147"></a>00147       pair.<a class="code" href="struct_udine_1_1_course_period_pair.html#d0ac51cc90d80dbfb34996643bf243bf">course</a> = c;
<a name="l00148"></a>00148       <span class="keywordflow">try</span> { 
<a name="l00149"></a>00149         IloExpr sum(<a class="code" href="class_udine_1_1_strategy_i.html#a588eceb4e1520c02b2255162374757e">env</a>);
<a name="l00150"></a>00150         <span class="keywordflow">for</span> (r = 0; r &lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#0236aa15c9e367c0b235a5398d19356c">getRoomCount</a>(<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a>); r++)
<a name="l00151"></a>00151           sum += <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#a2eb63247509b9e19c3ca82b1ff3becd">x</a>[p][r][c];
<a name="l00152"></a>00152         assert(std::fabs(1 - getValue(sum)) &lt; 0.0001 || std::fabs(getValue(sum)) &lt; 0.0001);
<a name="l00153"></a>00153         <span class="keywordflow">if</span> (<a class="code" href="strategy_8cpp.html#e32e602f9e9db5c127e1eece8c797425">roundProperly</a>(getValue(sum)) == 1)
<a name="l00154"></a>00154           next.<a class="code" href="struct_udine_1_1_neighbourhood.html#888ac9463e2eb016f4ab334bc901fc40">fixPeriod</a>.push_back(pair);
<a name="l00155"></a>00155         <span class="keywordflow">else</span> 
<a name="l00156"></a>00156           next.<a class="code" href="struct_udine_1_1_neighbourhood.html#e733c9b23d33925bb5a1a9bc5709f529">preprocessAway</a>.push_back(pair);
<a name="l00157"></a>00157         <span class="keywordflow">if</span> (<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a> == <a class="code" href="namespace_udine.html#1748c504ab86482c137f902a5b474378ebd0021c0608a1b50450cd305a2e9f4c">FixDay</a>)
<a name="l00158"></a>00158           assert(<a class="code" href="strategy_8cpp.html#e32e602f9e9db5c127e1eece8c797425">roundProperly</a>(getValue(sum)) == <a class="code" href="strategy_8cpp.html#e32e602f9e9db5c127e1eece8c797425">roundProperly</a>(getValue(<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#7b12dffddf2f2aaa1d63a6eff19f8fe7">coursePeriods</a>[c][p])));
<a name="l00159"></a>00159       } <span class="keywordflow">catch</span> (IloAlgorithm::NotExtractedException e)  { 
<a name="l00160"></a>00160         std::cerr &lt;&lt; <span class="stringliteral">"Error retrieving "</span> &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#a2eb63247509b9e19c3ca82b1ff3becd">x</a>[p][r][c].getName() &lt;&lt; <span class="stringliteral">"."</span> &lt;&lt; std::endl; 
<a name="l00161"></a>00161       } <span class="keywordflow">catch</span> (...)  { 
<a name="l00162"></a>00162         std::cerr &lt;&lt; <span class="stringliteral">"Unknown error retrieving "</span> &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#a2eb63247509b9e19c3ca82b1ff3becd">x</a>[p][r][c].getName() &lt;&lt; <span class="stringliteral">"."</span> &lt;&lt; std::endl; 
<a name="l00163"></a>00163         <span class="keywordflow">throw</span>; 
<a name="l00164"></a>00164       }
<a name="l00165"></a>00165     }
<a name="l00166"></a>00166   <span class="keywordflow">return</span> next;
<a name="l00167"></a>00167 }
<a name="l00168"></a>00168 
<a name="l00169"></a>00169 
<a name="l00170"></a><a class="code" href="class_udine_1_1_strategy_i.html#0cd2545fc7b1d815a30354edb7467294">00170</a> <a class="code" href="struct_udine_1_1_neighbourhood.html">Neighbourhood</a> <a class="code" href="class_udine_1_1_strategy_i.html#0cd2545fc7b1d815a30354edb7467294">StrategyI::getFixDayNeighbourhood</a>() {
<a name="l00171"></a>00171   <a class="code" href="struct_udine_1_1_neighbourhood.html">Neighbourhood</a> next;
<a name="l00172"></a>00172   next.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a> = <a class="code" href="namespace_udine.html#1748c504ab86482c137f902a5b474378ebd0021c0608a1b50450cd305a2e9f4c">FixDay</a>;
<a name="l00173"></a>00173   next.<a class="code" href="struct_udine_1_1_neighbourhood.html#8856b8dea41bbcfe7d2b050ec6018907">cost</a> = getObjValue();
<a name="l00174"></a>00174   next.<a class="code" href="struct_udine_1_1_neighbourhood.html#e74c0a29e06868cbba038e8ae9500f82">lowerBound</a> = getBestObjValue();
<a name="l00175"></a>00175   next.<a class="code" href="struct_udine_1_1_neighbourhood.html#4f6c8b92a5f71100d10b8c698ecca3ef">penaltyMinCourseDays</a> = <a class="code" href="class_udine_1_1_strategy_i.html#c9b811d84791229ad00ec99441671cf3">sumMissingCourseDays</a>();
<a name="l00176"></a>00176   next.<a class="code" href="struct_udine_1_1_neighbourhood.html#69f83574b01b2b10f11d76405eb116b1">penaltyCompactness</a> = <a class="code" href="class_udine_1_1_strategy_i.html#045b6e91b05c618173a100a72b097eb4">sumSingletonChecks</a>();
<a name="l00177"></a>00177   <span class="keywordtype">int</span> c, d, p, r;  <span class="comment">// course, day, period, room</span>
<a name="l00178"></a>00178 
<a name="l00179"></a>00179   <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#6020dc8bfec316fa74b5594ce6bb12e9">getCourseCount</a>(); c++) {
<a name="l00180"></a>00180     <a class="code" href="struct_udine_1_1_course_period_pair.html">CoursePeriodPair</a> pair;
<a name="l00181"></a>00181     pair.<a class="code" href="struct_udine_1_1_course_period_pair.html#d0ac51cc90d80dbfb34996643bf243bf">course</a> = c;
<a name="l00182"></a>00182     <a class="code" href="struct_udine_1_1_course_day_number_triple.html">CourseDayNumberTriple</a> triple;
<a name="l00183"></a>00183     triple.<a class="code" href="struct_udine_1_1_course_day_number_triple.html#5987baa72cd9142053b203560f89434b">course</a> = c;
<a name="l00184"></a>00184 
<a name="l00185"></a>00185     <span class="keywordflow">for</span> (d = 0; d &lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#a69b0cbf804f657b02b9bebd807a11ce">getDayCount</a>(); d++) {
<a name="l00186"></a>00186       triple.<a class="code" href="struct_udine_1_1_course_day_number_triple.html#249c02883e7f5e7c930640d8ea5fec2a">day</a> = d;
<a name="l00187"></a>00187       triple.<a class="code" href="struct_udine_1_1_course_day_number_triple.html#5e18d101d68990c429929a80e8ed3641">events</a> = 0;
<a name="l00188"></a>00188       <span class="keywordtype">bool</span> ok = <span class="keyword">true</span>;
<a name="l00189"></a>00189 
<a name="l00190"></a>00190       <span class="keywordflow">for</span> (p = d * <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#c1d2656cb45a9b3f09c3dc8f4096f5d5">getPeriodsPerDayCount</a>(); 
<a name="l00191"></a>00191            p &lt; (d + 1) * <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#c1d2656cb45a9b3f09c3dc8f4096f5d5">getPeriodsPerDayCount</a>(); p++)
<a name="l00192"></a>00192         <span class="keywordflow">try</span> {
<a name="l00193"></a>00193           IloExpr sum(<a class="code" href="class_udine_1_1_strategy_i.html#a588eceb4e1520c02b2255162374757e">env</a>);
<a name="l00194"></a>00194           <span class="keywordflow">for</span> (r = 0; r &lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#0236aa15c9e367c0b235a5398d19356c">getRoomCount</a>(<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a>); r++)
<a name="l00195"></a>00195             sum += <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#a2eb63247509b9e19c3ca82b1ff3becd">x</a>[p][r][c];
<a name="l00196"></a>00196           triple.<a class="code" href="struct_udine_1_1_course_day_number_triple.html#5e18d101d68990c429929a80e8ed3641">events</a> += <a class="code" href="strategy_8cpp.html#e32e602f9e9db5c127e1eece8c797425">roundProperly</a>(getValue(sum));
<a name="l00197"></a>00197         } <span class="keywordflow">catch</span> (IloAlgorithm::NotExtractedException e)  { 
<a name="l00198"></a>00198           std::cerr &lt;&lt; <span class="stringliteral">"Error retrieving value of x for c = "</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">" and d = "</span> &lt;&lt; d &lt;&lt; <span class="stringliteral">"."</span> &lt;&lt; std::endl;
<a name="l00199"></a>00199           ok = <span class="keyword">false</span>; 
<a name="l00200"></a>00200         } <span class="keywordflow">catch</span> (...) { 
<a name="l00201"></a>00201           std::cerr &lt;&lt; <span class="stringliteral">"Unknown error retrieving value of x for c = "</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">" and d = "</span> &lt;&lt; d &lt;&lt; <span class="stringliteral">"."</span> &lt;&lt; std::endl; 
<a name="l00202"></a>00202           <span class="keywordflow">throw</span>; 
<a name="l00203"></a>00203         }
<a name="l00204"></a>00204 
<a name="l00205"></a>00205       <span class="keywordflow">if</span> (triple.<a class="code" href="struct_udine_1_1_course_day_number_triple.html#5e18d101d68990c429929a80e8ed3641">events</a> &gt; 0) { 
<a name="l00206"></a>00206         next.<a class="code" href="struct_udine_1_1_neighbourhood.html#150b82a8e44425ee30c140668e59c5c5">fixDay</a>.push_back(triple);
<a name="l00207"></a>00207       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ok)
<a name="l00208"></a>00208         <span class="keywordflow">for</span> (p = d * <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#c1d2656cb45a9b3f09c3dc8f4096f5d5">getPeriodsPerDayCount</a>(); 
<a name="l00209"></a>00209              p &lt; (d + 1) * <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#c1d2656cb45a9b3f09c3dc8f4096f5d5">getPeriodsPerDayCount</a>(); 
<a name="l00210"></a>00210              p++) {
<a name="l00211"></a>00211         pair.<a class="code" href="struct_udine_1_1_course_period_pair.html#56ea1139126925afd8e55ffdd78a4246">period</a> = p;
<a name="l00212"></a>00212         next.<a class="code" href="struct_udine_1_1_neighbourhood.html#e733c9b23d33925bb5a1a9bc5709f529">preprocessAway</a>.push_back(pair);
<a name="l00213"></a>00213       }
<a name="l00214"></a>00214     }
<a name="l00215"></a>00215   }
<a name="l00216"></a>00216 
<a name="l00217"></a>00217   <span class="keywordflow">return</span> next;
<a name="l00218"></a>00218 }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220 
<a name="l00221"></a><a class="code" href="class_udine_1_1_strategy_i.html#76cd939eb3df88b6ba30b7f977e317d5">00221</a> <span class="keywordtype">void</span> <a class="code" href="class_udine_1_1_strategy_i.html#76cd939eb3df88b6ba30b7f977e317d5">StrategyI::runDiver</a>(<a class="code" href="struct_udine_1_1_neighbourhood.html">Neighbourhood</a> next) {
<a name="l00222"></a>00222 
<a name="l00223"></a>00223   <span class="keywordflow">try</span> {  
<a name="l00224"></a>00224 
<a name="l00225"></a>00225     IloModel subMIPModel(<a class="code" href="class_udine_1_1_strategy_i.html#a588eceb4e1520c02b2255162374757e">env</a>);
<a name="l00226"></a>00226     <a class="code" href="class_udine_1_1_model.html">Model</a> subMIP(subMIPModel, <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#c6b5bc705201030d6d7f2001dab10788">config</a>, <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>, <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#dc3232ba292becc230436c5a14073a90">conflictGraph</a>, next);
<a name="l00227"></a>00227     IloCplex cplex(subMIPModel);
<a name="l00228"></a>00228 
<a name="l00229"></a>00229     <span class="keywordflow">if</span> (<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#c6b5bc705201030d6d7f2001dab10788">config</a>.<a class="code" href="struct_udine_1_1_config.html#442ff0dfb189dd3f733e0876f3c17405">getParam</a>(<a class="code" href="namespace_udine.html#7a28bfbd1d7d606db82f999b139d9aae65ad86a0d514810358d356e097503d4d">UseLpFilesExport</a>)) {
<a name="l00230"></a>00230       std::stringstream filename;
<a name="l00231"></a>00231       filename &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#19bdbb787d800b77fe8565ea543173b1">path</a> &lt;&lt; <span class="stringliteral">"."</span> &lt;&lt; next.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a> &lt;&lt; next.<a class="code" href="struct_udine_1_1_neighbourhood.html#8856b8dea41bbcfe7d2b050ec6018907">cost</a> &lt;&lt; <span class="stringliteral">".lp"</span>;
<a name="l00232"></a>00232       cplex.exportModel(filename.str().c_str());
<a name="l00233"></a>00233     }
<a name="l00234"></a>00234 
<a name="l00235"></a>00235     <a class="code" href="class_udine_1_1_strategy_i.html#a588eceb4e1520c02b2255162374757e">env</a>.out() &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">"Diving into the "</span> &lt;&lt; next.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a> &lt;&lt; <span class="stringliteral">" neighbouhood from "</span>;
<a name="l00236"></a>00236     <a class="code" href="class_udine_1_1_strategy_i.html#a588eceb4e1520c02b2255162374757e">env</a>.out() &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a> &lt;&lt; <span class="stringliteral">" ..."</span> &lt;&lt; std::endl;
<a name="l00237"></a>00237     
<a name="l00238"></a>00238     <a class="code" href="class_udine_1_1_strategy_i.html">StrategyI</a> *strategy = NULL;
<a name="l00239"></a>00239     <span class="keywordflow">if</span> (next.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a> == <a class="code" href="namespace_udine.html#1748c504ab86482c137f902a5b474378ebd0021c0608a1b50450cd305a2e9f4c">FixDay</a>)
<a name="l00240"></a>00240       strategy = <span class="keyword">new</span> (<a class="code" href="class_udine_1_1_strategy_i.html#a588eceb4e1520c02b2255162374757e">env</a>) <a class="code" href="class_udine_1_1_solution_polishing_strategy_i.html">SolutionPolishingStrategyI</a>(<a class="code" href="class_udine_1_1_strategy_i.html#a588eceb4e1520c02b2255162374757e">env</a>, subMIP, <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>);
<a name="l00241"></a>00241     <span class="keywordflow">else</span> <span class="comment">// NOTE: assumes model.config.getParam(UseSolutionLogging)</span>
<a name="l00242"></a>00242       strategy = <span class="keyword">new</span> (<a class="code" href="class_udine_1_1_strategy_i.html#a588eceb4e1520c02b2255162374757e">env</a>) <a class="code" href="class_udine_1_1_solution_saving_strategy_i.html">SolutionSavingStrategyI</a>(<a class="code" href="class_udine_1_1_strategy_i.html#a588eceb4e1520c02b2255162374757e">env</a>, subMIP, <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>);
<a name="l00243"></a>00243     cplex.use(IloCplex::Callback(strategy));
<a name="l00244"></a>00244     
<a name="l00245"></a>00245     <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#062f07922a6545ac00afd9b54164f01f">apply</a>(cplex, next.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a>);
<a name="l00246"></a>00246     cplex.solve();
<a name="l00247"></a>00247     strategy-&gt;<a class="code" href="class_udine_1_1_strategy_i.html#83548b4bace50f695b498aadfea23dbe">finishOff</a>();
<a name="l00248"></a>00248   }
<a name="l00249"></a>00249   <span class="keywordflow">catch</span> (IloException&amp; e) { std::cerr &lt;&lt; <span class="stringliteral">"Solver (Strategy): Concert exception caught: "</span> &lt;&lt; e &lt;&lt; std::endl; }
<a name="l00250"></a>00250   <span class="keywordflow">catch</span> (...) { std::cerr &lt;&lt; <span class="stringliteral">"Solver (Strategy): Unknown exception caught."</span> &lt;&lt; std::endl; }
<a name="l00251"></a>00251 }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253 
<a name="l00254"></a>00254 <span class="comment">/*** Anytime Strategy *************************************/</span>
<a name="l00255"></a>00255 
<a name="l00256"></a><a class="code" href="namespace_udine.html#6e9cf562bccdf65b87a2f5b950373577">00256</a> IloCplex::Callback <a class="code" href="namespace_udine.html#6e9cf562bccdf65b87a2f5b950373577">AnytimeStrategy</a>(IloEnv &amp;env, <a class="code" href="class_udine_1_1_model.html">Model</a>&amp; s, <a class="code" href="struct_udine_1_1_config.html">Config</a> &amp;configuration) {
<a name="l00257"></a>00257   <span class="keywordflow">return</span> (IloCplex::Callback(<span class="keyword">new</span> (env) <a class="code" href="class_udine_1_1_anytime_strategy_i.html">AnytimeStrategyI</a>(env, s, configuration)));
<a name="l00258"></a>00258 }
<a name="l00259"></a>00259 
<a name="l00260"></a>00260 
<a name="l00261"></a><a class="code" href="class_udine_1_1_anytime_strategy_i.html#31784ebdb286c5e58630b2455479eeb4">00261</a> <span class="keywordtype">void</span> <a class="code" href="class_udine_1_1_anytime_strategy_i.html#31784ebdb286c5e58630b2455479eeb4">AnytimeStrategyI::main</a>() {
<a name="l00262"></a>00262   <span class="keywordflow">if</span> (   <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#fbcc7940eea0faf49138e3a266dc679a">anytimeDivingOnset</a>[<a class="code" href="namespace_udine.html#1748c504ab86482c137f902a5b474378d0dea5c2f48fa71a1600db62dc494764">FixPeriod</a>] &gt;= 0
<a name="l00263"></a>00263       &amp;&amp; <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#5d418a03e5e6c0ebe839987e82b2aba0">elapsed</a>() &gt; <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#fbcc7940eea0faf49138e3a266dc679a">anytimeDivingOnset</a>[<a class="code" href="namespace_udine.html#1748c504ab86482c137f902a5b474378d0dea5c2f48fa71a1600db62dc494764">FixPeriod</a>]) {
<a name="l00264"></a>00264       <a class="code" href="struct_udine_1_1_neighbourhood.html">Neighbourhood</a> def = <a class="code" href="class_udine_1_1_strategy_i.html#05c87bf6b3c74568bc31e5c4a996aa36">getFixPeriodNeighbourhood</a>();
<a name="l00265"></a>00265       <a class="code" href="class_udine_1_1_strategy_i.html#20467bca4c6426ce299a24a53ee94f2b">logNeighbrouhood</a>(def);
<a name="l00266"></a>00266       <a class="code" href="class_udine_1_1_strategy_i.html#76cd939eb3df88b6ba30b7f977e317d5">runDiver</a>(def);
<a name="l00267"></a>00267     }
<a name="l00268"></a>00268   <span class="keywordflow">if</span> (   <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#fbcc7940eea0faf49138e3a266dc679a">anytimeDivingOnset</a>[<a class="code" href="namespace_udine.html#1748c504ab86482c137f902a5b474378ebd0021c0608a1b50450cd305a2e9f4c">FixDay</a>] &gt;= 0
<a name="l00269"></a>00269       &amp;&amp; <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#5d418a03e5e6c0ebe839987e82b2aba0">elapsed</a>() &gt; <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#fbcc7940eea0faf49138e3a266dc679a">anytimeDivingOnset</a>[<a class="code" href="namespace_udine.html#1748c504ab86482c137f902a5b474378ebd0021c0608a1b50450cd305a2e9f4c">FixDay</a>]) {
<a name="l00270"></a>00270       <a class="code" href="struct_udine_1_1_neighbourhood.html">Neighbourhood</a> def = <a class="code" href="class_udine_1_1_strategy_i.html#0cd2545fc7b1d815a30354edb7467294">getFixDayNeighbourhood</a>();
<a name="l00271"></a>00271       <a class="code" href="class_udine_1_1_strategy_i.html#20467bca4c6426ce299a24a53ee94f2b">logNeighbrouhood</a>(def);
<a name="l00272"></a>00272       <a class="code" href="class_udine_1_1_strategy_i.html#76cd939eb3df88b6ba30b7f977e317d5">runDiver</a>(def);
<a name="l00273"></a>00273     }
<a name="l00274"></a>00274 }
<a name="l00275"></a>00275 
<a name="l00276"></a><a class="code" href="class_udine_1_1_anytime_strategy_i.html#dad674b6ba877bb76cdce332da6d9d1a">00276</a> <span class="keywordtype">void</span> <a class="code" href="class_udine_1_1_anytime_strategy_i.html#dad674b6ba877bb76cdce332da6d9d1a">AnytimeStrategyI::finishOff</a>() {
<a name="l00277"></a>00277 }
<a name="l00278"></a>00278 
<a name="l00279"></a>00279 
<a name="l00280"></a>00280 <span class="comment">/*** Contract Strategy ************************************/</span>
<a name="l00281"></a>00281 
<a name="l00282"></a><a class="code" href="namespace_udine.html#bac77425b1a44c6e36ccad5646d1fd45">00282</a> IloCplex::Callback <a class="code" href="namespace_udine.html#bac77425b1a44c6e36ccad5646d1fd45">ContractStrategy</a>(IloEnv &amp;env, <a class="code" href="class_udine_1_1_model.html">Model</a>&amp; s, <a class="code" href="struct_udine_1_1_config.html">Config</a> &amp;configuration) {
<a name="l00283"></a>00283   <span class="keywordflow">return</span> (IloCplex::Callback(<span class="keyword">new</span> (env) <a class="code" href="class_udine_1_1_contract_strategy_i.html">ContractStrategyI</a>(env, s, configuration)));
<a name="l00284"></a>00284 }
<a name="l00285"></a>00285 
<a name="l00286"></a>00286 
<a name="l00287"></a><a class="code" href="class_udine_1_1_contract_strategy_i.html#69c594d3d4e4f63dd36ae12aaf5ba54b">00287</a> <span class="keywordtype">void</span> <a class="code" href="class_udine_1_1_contract_strategy_i.html#69c594d3d4e4f63dd36ae12aaf5ba54b">ContractStrategyI::main</a>() {
<a name="l00288"></a>00288   <a class="code" href="class_udine_1_1_contract_strategy_i.html#7d90b4c288a3070836ca1672da26f04e">fixDayNeighbs</a>.push_back(<a class="code" href="class_udine_1_1_strategy_i.html#0cd2545fc7b1d815a30354edb7467294">getFixDayNeighbourhood</a>());
<a name="l00289"></a>00289   <a class="code" href="class_udine_1_1_contract_strategy_i.html#148d1566da0f6f9217d5bc43e9845a75">fixPeriodNeighbs</a>.push_back(<a class="code" href="class_udine_1_1_strategy_i.html#05c87bf6b3c74568bc31e5c4a996aa36">getFixPeriodNeighbourhood</a>());
<a name="l00290"></a>00290   <a class="code" href="class_udine_1_1_strategy_i.html#20467bca4c6426ce299a24a53ee94f2b">logNeighbrouhood</a>(<a class="code" href="class_udine_1_1_contract_strategy_i.html#7d90b4c288a3070836ca1672da26f04e">fixDayNeighbs</a>.back());
<a name="l00291"></a>00291 }
<a name="l00292"></a>00292 
<a name="l00293"></a><a class="code" href="class_udine_1_1_contract_strategy_i.html#807b510e83962bb97835b92fd229de59">00293</a> <span class="keywordtype">void</span> <a class="code" href="class_udine_1_1_contract_strategy_i.html#807b510e83962bb97835b92fd229de59">ContractStrategyI::finishOff</a>() {
<a name="l00294"></a>00294   <span class="keywordtype">int</span> counter = 0;
<a name="l00295"></a>00295   <span class="keywordflow">while</span>  (<a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#5d418a03e5e6c0ebe839987e82b2aba0">elapsed</a>() &lt; <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#7cdee02cd941a8c371212368abdc9a91">contractTimelimit</a> 
<a name="l00296"></a>00296        &amp;&amp; !<a class="code" href="class_udine_1_1_contract_strategy_i.html#148d1566da0f6f9217d5bc43e9845a75">fixPeriodNeighbs</a>.empty()
<a name="l00297"></a>00297        &amp;&amp; counter &lt; <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#b8b3cff96e6db24cc5a4109644fcb4e8">getCount</a>(<a class="code" href="namespace_udine.html#1373e348728705a8af111739b30128ee90e6649e07e33dd33878560eea3efd56">FixPeriodDiveFromSurface</a>))
<a name="l00298"></a>00298     <span class="keywordflow">try</span> {
<a name="l00299"></a>00299       <a class="code" href="class_udine_1_1_strategy_i.html#76cd939eb3df88b6ba30b7f977e317d5">runDiver</a>(<a class="code" href="class_udine_1_1_contract_strategy_i.html#148d1566da0f6f9217d5bc43e9845a75">fixPeriodNeighbs</a>.back());
<a name="l00300"></a>00300       <a class="code" href="class_udine_1_1_contract_strategy_i.html#148d1566da0f6f9217d5bc43e9845a75">fixPeriodNeighbs</a>.pop_back();
<a name="l00301"></a>00301       counter += 1;
<a name="l00302"></a>00302     } <span class="keywordflow">catch</span> (std::exception &amp;e) { std::cerr &lt;&lt; <span class="stringliteral">"Solver (FixPeriod Dives): "</span> &lt;&lt; e.what() &lt;&lt; std::endl; }
<a name="l00303"></a>00303   counter = 0;
<a name="l00304"></a>00304   <span class="keywordflow">while</span>   (<a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#5d418a03e5e6c0ebe839987e82b2aba0">elapsed</a>() &lt; <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#7cdee02cd941a8c371212368abdc9a91">contractTimelimit</a> 
<a name="l00305"></a>00305         &amp;&amp; !<a class="code" href="class_udine_1_1_contract_strategy_i.html#7d90b4c288a3070836ca1672da26f04e">fixDayNeighbs</a>.empty()
<a name="l00306"></a>00306         &amp;&amp; counter &lt; <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#b8b3cff96e6db24cc5a4109644fcb4e8">getCount</a>(<a class="code" href="namespace_udine.html#1373e348728705a8af111739b30128ee8026f42a56afaf656941bf846b2a09c8">FixDayDiveFromSurface</a>)) {
<a name="l00307"></a>00307     <span class="keywordflow">try</span> {
<a name="l00308"></a>00308       <a class="code" href="class_udine_1_1_strategy_i.html#76cd939eb3df88b6ba30b7f977e317d5">runDiver</a>(<a class="code" href="class_udine_1_1_contract_strategy_i.html#7d90b4c288a3070836ca1672da26f04e">fixDayNeighbs</a>.back());
<a name="l00309"></a>00309       <a class="code" href="class_udine_1_1_contract_strategy_i.html#7d90b4c288a3070836ca1672da26f04e">fixDayNeighbs</a>.pop_back();
<a name="l00310"></a>00310       counter += 1;
<a name="l00311"></a>00311     } <span class="keywordflow">catch</span> (std::exception &amp;e) { std::cerr &lt;&lt; <span class="stringliteral">"Solver (FixDay Dives): "</span> &lt;&lt; e.what() &lt;&lt; std::endl; }
<a name="l00312"></a>00312   }
<a name="l00313"></a>00313 }
<a name="l00314"></a>00314 
<a name="l00315"></a>00315 <span class="comment">/*** Solution Saving Strategy ************************************/</span>
<a name="l00316"></a>00316 
<a name="l00317"></a><a class="code" href="namespace_udine.html#09dd92c8f8a5968752e7374f5d85503e">00317</a> IloCplex::Callback <a class="code" href="namespace_udine.html#09dd92c8f8a5968752e7374f5d85503e">SolutionSavingStrategy</a>(IloEnv &amp;env, <a class="code" href="class_udine_1_1_model.html">Model</a>&amp; s, <a class="code" href="struct_udine_1_1_config.html">Config</a> &amp;configuration) {
<a name="l00318"></a>00318   <span class="keywordflow">return</span> (IloCplex::Callback(<span class="keyword">new</span> (env) <a class="code" href="class_udine_1_1_solution_saving_strategy_i.html">SolutionSavingStrategyI</a>(env, s, configuration)));
<a name="l00319"></a>00319 }
<a name="l00320"></a>00320 
<a name="l00321"></a><a class="code" href="class_udine_1_1_solution_saving_strategy_i.html#6e76979b8a1baecf39e957fdef014ffe">00321</a> <span class="keywordtype">void</span> <a class="code" href="class_udine_1_1_solution_saving_strategy_i.html#6e76979b8a1baecf39e957fdef014ffe">SolutionSavingStrategyI::main</a>() {
<a name="l00322"></a>00322   <span class="keywordflow">try</span> {
<a name="l00323"></a>00323     std::stringstream log;
<a name="l00324"></a>00324     std::stringstream sol;
<a name="l00325"></a>00325 
<a name="l00326"></a>00326     <span class="keywordtype">int</span> pRoomCapacity = <a class="code" href="class_udine_1_1_strategy_i.html#34cb6a3734cc8cd25589b2946c2e6a45">sumMissingSeats</a>();
<a name="l00327"></a>00327     <span class="keywordtype">int</span> pMinDays = <a class="code" href="class_udine_1_1_strategy_i.html#c9b811d84791229ad00ec99441671cf3">sumMissingCourseDays</a>();
<a name="l00328"></a>00328     <span class="keywordtype">int</span> pCompactness = <a class="code" href="class_udine_1_1_strategy_i.html#045b6e91b05c618173a100a72b097eb4">sumSingletonChecks</a>();
<a name="l00329"></a>00329     <span class="keywordtype">int</span> pRoomStability = <a class="code" href="class_udine_1_1_strategy_i.html#b1995072fcfd33d9e4844daad65d909b">sumExtraRoomsUsed</a>();
<a name="l00330"></a>00330     <span class="keywordtype">int</span> pTotal = 
<a name="l00331"></a>00331       <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#82d2d58a1a4b1cb32ab7866b861c23f1">getWeights</a>(<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a>).<a class="code" href="struct_udine_1_1_objective_weights.html#75aeba184b1821209a7c81fa34e8c2bf">wMinDays</a> * pMinDays + 
<a name="l00332"></a>00332       <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#82d2d58a1a4b1cb32ab7866b861c23f1">getWeights</a>(<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a>).<a class="code" href="struct_udine_1_1_objective_weights.html#c12f7ae3c13315d000f2aecddb86479e">wCompactness</a> * pCompactness + 
<a name="l00333"></a>00333       <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#82d2d58a1a4b1cb32ab7866b861c23f1">getWeights</a>(<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a>).<a class="code" href="struct_udine_1_1_objective_weights.html#dd02352abd55e229bd154f0cc665f49d">wRoomCapacity</a> * pRoomCapacity + 
<a name="l00334"></a>00334       <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#82d2d58a1a4b1cb32ab7866b861c23f1">getWeights</a>(<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a>).<a class="code" href="struct_udine_1_1_objective_weights.html#6f65b00ba7a6a851fbda23d8135e62cd">wRoomStability</a> * pRoomStability;
<a name="l00335"></a>00335 
<a name="l00336"></a>00336     log &lt;&lt; <span class="stringliteral">"&lt;solution submodelCost='"</span> &lt;&lt; getObjValue() &lt;&lt; <span class="stringliteral">"' "</span>;
<a name="l00337"></a>00337     log &lt;&lt; <span class="stringliteral">"cost='"</span> &lt;&lt; pTotal &lt;&lt; <span class="stringliteral">"' "</span>;
<a name="l00338"></a>00338     log &lt;&lt; <span class="stringliteral">"data='"</span> &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#19bdbb787d800b77fe8565ea543173b1">path</a> &lt;&lt; <span class="stringliteral">"' "</span>;
<a name="l00339"></a>00339     log &lt;&lt; <span class="stringliteral">"type='"</span> &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a> &lt;&lt; <span class="stringliteral">"' "</span>;
<a name="l00340"></a>00340     log &lt;&lt; <span class="stringliteral">"discovered='"</span> &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#5d418a03e5e6c0ebe839987e82b2aba0">elapsed</a>() &lt;&lt; <span class="stringliteral">"' "</span>;
<a name="l00341"></a>00341     log &lt;&lt; <span class="stringliteral">"neighbourhoodLB='"</span> &lt;&lt; getBestObjValue() &lt;&lt; <span class="stringliteral">"' "</span>;
<a name="l00342"></a>00342     log &lt;&lt; <span class="stringliteral">"penaltyRoomCapacity='"</span> &lt;&lt; pRoomCapacity &lt;&lt; <span class="stringliteral">"' "</span>;
<a name="l00343"></a>00343     log &lt;&lt; <span class="stringliteral">"penaltyMinCourseDays='"</span> &lt;&lt; pMinDays &lt;&lt; <span class="stringliteral">"' "</span>;
<a name="l00344"></a>00344     log &lt;&lt; <span class="stringliteral">"penaltyCompactness='"</span> &lt;&lt; pCompactness &lt;&lt; <span class="stringliteral">"' "</span>;
<a name="l00345"></a>00345     log &lt;&lt; <span class="stringliteral">"penaltyRoomStability='"</span> &lt;&lt; pRoomStability &lt;&lt; <span class="stringliteral">"' "</span>;
<a name="l00346"></a>00346 
<a name="l00347"></a>00347     log &lt;&lt; <span class="stringliteral">"&gt;\n"</span>;
<a name="l00348"></a>00348 
<a name="l00349"></a>00349     <span class="keywordtype">int</span> c, p, r;  <span class="comment">// course, period, room</span>
<a name="l00350"></a>00350     <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#6020dc8bfec316fa74b5594ce6bb12e9">getCourseCount</a>(); c++)
<a name="l00351"></a>00351       <span class="keywordflow">for</span>(p = 0; p &lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#e66c619fb7725c038dad84d29cf7880e">getPeriodCount</a>(); p++) {
<a name="l00352"></a>00352         <span class="keywordtype">int</span> day = (int)std::floor(<span class="keywordtype">float</span>(p / <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#c1d2656cb45a9b3f09c3dc8f4096f5d5">getPeriodsPerDayCount</a>()));
<a name="l00353"></a>00353         <span class="keywordtype">int</span> periodWithin = p % <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#c1d2656cb45a9b3f09c3dc8f4096f5d5">getPeriodsPerDayCount</a>();
<a name="l00354"></a>00354         <span class="keywordflow">for</span>(r = 0; r &lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#0236aa15c9e367c0b235a5398d19356c">getRoomCount</a>(<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a>); r++)
<a name="l00355"></a>00355           <span class="keywordflow">try</span> {
<a name="l00356"></a>00356             <span class="keywordflow">if</span> (<a class="code" href="strategy_8cpp.html#e32e602f9e9db5c127e1eece8c797425">roundProperly</a>(getValue(<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#a2eb63247509b9e19c3ca82b1ff3becd">x</a>[p][r][c])) == 1) {
<a name="l00357"></a>00357               log &lt;&lt; <span class="stringliteral">"&lt;session course='"</span> &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#4c909a0eef4e65ba4ab46d61b64fbca3">getCourse</a>(c).<a class="code" href="struct_udine_1_1_course.html#cd3122bcf966c9853a88871541328e75">name</a>;
<a name="l00358"></a>00358               log &lt;&lt; <span class="stringliteral">"' room='"</span> &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#dd4036fa0d38447a03c9e0ebacdfc019">getRoomName</a>(r);
<a name="l00359"></a>00359               log &lt;&lt; <span class="stringliteral">"' period='"</span> &lt;&lt; p;
<a name="l00360"></a>00360               log &lt;&lt; <span class="stringliteral">"' day='"</span> &lt;&lt; day;
<a name="l00361"></a>00361               log &lt;&lt; <span class="stringliteral">"' periodWithin='"</span> &lt;&lt; periodWithin;
<a name="l00362"></a>00362               log &lt;&lt; <span class="stringliteral">"'/&gt; "</span>;
<a name="l00363"></a>00363               sol &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#4c909a0eef4e65ba4ab46d61b64fbca3">getCourse</a>(c).<a class="code" href="struct_udine_1_1_course.html#cd3122bcf966c9853a88871541328e75">name</a> &lt;&lt; <span class="stringliteral">" "</span>;
<a name="l00364"></a>00364               sol &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#e1a1e700d38b731c4785686fc2badeed">instance</a>.<a class="code" href="class_udine_1_1_instance.html#dd4036fa0d38447a03c9e0ebacdfc019">getRoomName</a>(r) &lt;&lt; <span class="stringliteral">" "</span>;
<a name="l00365"></a>00365               sol &lt;&lt; day &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; periodWithin &lt;&lt; <span class="stringliteral">"\n"</span>;
<a name="l00366"></a>00366             }
<a name="l00367"></a>00367           } <span class="keywordflow">catch</span> (IloAlgorithm::NotExtractedException e)  { std::cerr &lt;&lt; <span class="stringliteral">"Error retrieving "</span> &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#a2eb63247509b9e19c3ca82b1ff3becd">x</a>[p][r][c].getName() &lt;&lt; <span class="stringliteral">"."</span> &lt;&lt; std::endl; }
<a name="l00368"></a>00368             <span class="keywordflow">catch</span> (...)  { std::cerr &lt;&lt; <span class="stringliteral">"Unknown error retrieving "</span> &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#102fa262004a7b6229173b43c8000f95">vars</a>.<a class="code" href="struct_udine_1_1_variables.html#a2eb63247509b9e19c3ca82b1ff3becd">x</a>[p][r][c].getName() &lt;&lt; <span class="stringliteral">"."</span> &lt;&lt; std::endl; <span class="keywordflow">throw</span>; }
<a name="l00369"></a>00369           
<a name="l00370"></a>00370       }
<a name="l00371"></a>00371 
<a name="l00372"></a>00372     log &lt;&lt; <span class="stringliteral">"&lt;/solution&gt;\n"</span>;
<a name="l00373"></a>00373 
<a name="l00374"></a>00374     <a class="code" href="class_udine_1_1_strategy_i.html#a588eceb4e1520c02b2255162374757e">env</a>.out() &lt;&lt; <span class="stringliteral">"&lt;/cplex&gt;\n"</span> &lt;&lt; log.str();
<a name="l00375"></a>00375     <a class="code" href="class_udine_1_1_strategy_i.html#a588eceb4e1520c02b2255162374757e">env</a>.out() &lt;&lt; <span class="stringliteral">"\n&lt;cplex&gt;"</span> &lt;&lt; std::endl;
<a name="l00376"></a>00376 
<a name="l00377"></a>00377     std::stringstream xmlname;
<a name="l00378"></a>00378     xmlname &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#19bdbb787d800b77fe8565ea543173b1">path</a> &lt;&lt; <span class="stringliteral">".sol"</span> &lt;&lt; pTotal &lt;&lt; <span class="stringliteral">".xml"</span>;
<a name="l00379"></a>00379     std::ofstream solFile(xmlname.str().c_str(), ios::out);
<a name="l00380"></a>00380     solFile &lt;&lt; log.str() &lt;&lt; std::endl;
<a name="l00381"></a>00381     solFile.close();
<a name="l00382"></a>00382 
<a name="l00383"></a>00383     std::stringstream solname;
<a name="l00384"></a>00384     solname &lt;&lt; <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#19bdbb787d800b77fe8565ea543173b1">path</a> &lt;&lt; <span class="stringliteral">".sol"</span> &lt;&lt; pTotal &lt;&lt; <span class="stringliteral">".out"</span>;
<a name="l00385"></a>00385     solFile.open(solname.str().c_str(), ios::out);
<a name="l00386"></a>00386     solFile &lt;&lt; sol.str() &lt;&lt; std::endl;
<a name="l00387"></a>00387     solFile.close();
<a name="l00388"></a>00388 
<a name="l00389"></a>00389     <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#9fab37afc997f98ed30b5abbad902d55">addSolutionCost</a>(<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a>, pTotal);
<a name="l00390"></a>00390   }
<a name="l00391"></a>00391   <span class="keywordflow">catch</span> (IloException&amp; e) { <a class="code" href="class_udine_1_1_strategy_i.html#a588eceb4e1520c02b2255162374757e">env</a>.error() &lt;&lt; <span class="stringliteral">"Concert error: "</span> &lt;&lt; e &lt;&lt; std::endl; }
<a name="l00392"></a>00392   <span class="keywordflow">catch</span> (...) { <a class="code" href="class_udine_1_1_strategy_i.html#a588eceb4e1520c02b2255162374757e">env</a>.error() &lt;&lt; <span class="stringliteral">"Unknown error: "</span> &lt;&lt; std::endl; <span class="keywordflow">throw</span>; }
<a name="l00393"></a>00393 }
<a name="l00394"></a>00394 
<a name="l00395"></a><a class="code" href="class_udine_1_1_solution_saving_strategy_i.html#72e9677edabd99e05779c0fc344409a5">00395</a> <span class="keywordtype">void</span> <a class="code" href="class_udine_1_1_solution_saving_strategy_i.html#72e9677edabd99e05779c0fc344409a5">SolutionSavingStrategyI::finishOff</a>() {
<a name="l00396"></a>00396 }
<a name="l00397"></a>00397 
<a name="l00398"></a>00398 
<a name="l00399"></a>00399 <span class="comment">/*** Solution Polishing Strategy ************************************/</span>
<a name="l00400"></a>00400 
<a name="l00401"></a><a class="code" href="namespace_udine.html#8d8c254371e1a0aa526910a551322a41">00401</a> IloCplex::Callback <a class="code" href="namespace_udine.html#8d8c254371e1a0aa526910a551322a41">SolutionPolishingStrategy</a>(IloEnv &amp;env, <a class="code" href="class_udine_1_1_model.html">Model</a>&amp; s, <a class="code" href="struct_udine_1_1_config.html">Config</a> &amp;configuration) {
<a name="l00402"></a>00402   <span class="keywordflow">return</span> (IloCplex::Callback(<span class="keyword">new</span> (env) <a class="code" href="class_udine_1_1_solution_polishing_strategy_i.html">SolutionPolishingStrategyI</a>(env, s, configuration)));
<a name="l00403"></a>00403 }
<a name="l00404"></a>00404 
<a name="l00405"></a><a class="code" href="class_udine_1_1_solution_polishing_strategy_i.html#39021fd0764900d8ff6e4fa72adccf56">00405</a> <span class="keywordtype">void</span> <a class="code" href="class_udine_1_1_solution_polishing_strategy_i.html#39021fd0764900d8ff6e4fa72adccf56">SolutionPolishingStrategyI::main</a>() {
<a name="l00406"></a>00406   <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#9fab37afc997f98ed30b5abbad902d55">addSolutionCost</a>(<a class="code" href="class_udine_1_1_strategy_i.html#c37977ee8b13268603b6a8ab41e071cd">model</a>.<a class="code" href="class_udine_1_1_model.html#928587761859afb30c99cdb5bbb7b20b">definition</a>.<a class="code" href="struct_udine_1_1_neighbourhood.html#c3471fcbd33b97ef04823b49719d7fb6">type</a>, getObjValue());
<a name="l00407"></a>00407   <a class="code" href="class_udine_1_1_solution_polishing_strategy_i.html#8d688748d19ec45bad96ec800c2b9665">fixPeriodNeighbs</a>.push_back(<a class="code" href="class_udine_1_1_strategy_i.html#05c87bf6b3c74568bc31e5c4a996aa36">getFixPeriodNeighbourhood</a>());
<a name="l00408"></a>00408 }
<a name="l00409"></a>00409 
<a name="l00410"></a><a class="code" href="class_udine_1_1_solution_polishing_strategy_i.html#13f7941fed28801e509d8f9e59c69715">00410</a> <span class="keywordtype">void</span> <a class="code" href="class_udine_1_1_solution_polishing_strategy_i.html#13f7941fed28801e509d8f9e59c69715">SolutionPolishingStrategyI::finishOff</a>() {
<a name="l00411"></a>00411   <span class="keywordtype">int</span> counter = 0;
<a name="l00412"></a>00412   <span class="keywordflow">while</span> (   !<a class="code" href="class_udine_1_1_solution_polishing_strategy_i.html#8d688748d19ec45bad96ec800c2b9665">fixPeriodNeighbs</a>.empty() 
<a name="l00413"></a>00413          &amp;&amp; counter &lt; <a class="code" href="class_udine_1_1_strategy_i.html#88206bf5447f65d712d08bc9b67c0473">config</a>.<a class="code" href="struct_udine_1_1_config.html#b8b3cff96e6db24cc5a4109644fcb4e8">getCount</a>(<a class="code" href="namespace_udine.html#1373e348728705a8af111739b30128ee5765d16def38731750ef6b776f5bc8b7">FixPeriodDiveFromFixDay</a>)) {
<a name="l00414"></a>00414     <a class="code" href="class_udine_1_1_strategy_i.html#76cd939eb3df88b6ba30b7f977e317d5">runDiver</a>(<a class="code" href="class_udine_1_1_solution_polishing_strategy_i.html#8d688748d19ec45bad96ec800c2b9665">fixPeriodNeighbs</a>.back());
<a name="l00415"></a>00415     <a class="code" href="class_udine_1_1_solution_polishing_strategy_i.html#8d688748d19ec45bad96ec800c2b9665">fixPeriodNeighbs</a>.pop_back();
<a name="l00416"></a>00416     counter += 1;
<a name="l00417"></a>00417   }
<a name="l00418"></a>00418 }
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon May 11 19:03:07 2009 for MemosTimetabling by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9 </small></address>
</body>
</html>
